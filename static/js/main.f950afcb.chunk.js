(this["webpackJsonpreact-mesto-auth"]=this["webpackJsonpreact-mesto-auth"]||[]).push([[0],{31:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(21),s=n.n(o),i=n(6),r=(n(31),n(2)),l=n(3),u=n(22),p=n(23),d=n(4),j=n(13),b="https://auth.nomoreparties.co",m={reg:"signup",login:"signin",checkToken:"users/me"},h="/mesto-react",O="https://mesto.nomoreparties.co/v1",_="8e942f57-cf63-4abe-b1a4-d7c8e2f5f3b4",f="cohort-23",g={user:"users/me",cards:"cards",cardLikes:"cards/likes"},v=Object(j.a)("baseUrl"),x=Object(j.a)("headers"),C=Object(j.a)("pathUser"),N=Object(j.a)("pathCards"),k=Object(j.a)("cardLikes"),y=new(function(){function e(t){var n=t.baseUrl,a=t.headers,c=t.paths,o=c.user,s=c.cards,i=c.cardLikes;Object(u.a)(this,e),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,N,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object(d.a)(this,v)[v]=n,Object(d.a)(this,x)[x]=a,Object(d.a)(this,C)[C]=o,Object(d.a)(this,N)[N]=s,Object(d.a)(this,k)[k]=i}return Object(p.a)(e,[{key:"_checkResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"_serverConnectionGet",value:function(e){return fetch("".concat(Object(d.a)(this,v)[v],"/").concat(e),{headers:Object(d.a)(this,x)[x]}).then(this._checkResponse)}},{key:"_serverConnectionSend",value:function(e,t,n){return fetch("".concat(Object(d.a)(this,v)[v],"/").concat(e),{method:t,headers:Object(d.a)(this,x)[x],body:JSON.stringify(n)}).then(this._checkResponse)}},{key:"_serverConnectionEdit",value:function(e,t,n){return fetch("".concat(Object(d.a)(this,v)[v],"/").concat(e,"/").concat(n),{method:t,headers:Object(d.a)(this,x)[x]}).then(this._checkResponse)}},{key:"getInitialCards",value:function(){return this._serverConnectionGet(Object(d.a)(this,N)[N])}},{key:"getInitialUser",value:function(){return this._serverConnectionGet(Object(d.a)(this,C)[C])}},{key:"patchUpdateProfile",value:function(e,t){return this._serverConnectionSend(Object(d.a)(this,C)[C],"PATCH",{name:e,about:t})}},{key:"postAddCard",value:function(e,t){return this._serverConnectionSend(Object(d.a)(this,N)[N],"POST",{name:e,link:t})}},{key:"deleteCard",value:function(e){return this._serverConnectionEdit(Object(d.a)(this,N)[N],"DELETE",e)}},{key:"putAppendLike",value:function(e){return this._serverConnectionEdit(Object(d.a)(this,k)[k],"PUT",e)}},{key:"deleteLike",value:function(e){return this._serverConnectionEdit(Object(d.a)(this,k)[k],"DELETE",e)}},{key:"patchUpdateUserAvatar",value:function(e){return this._serverConnectionSend("".concat(Object(d.a)(this,C)[C],"/avatar"),"PATCH",{avatar:e})}}]),e}())({baseUrl:"".concat(O,"/").concat(f),headers:{authorization:_,"Content-Type":"application/json"},paths:g}),P=n.p+"static/media/preloaderProfileImg.e8e535d6.gif",S=n(25),A=n.p+"static/media/logo.5f0f2709.svg",E=n(0);var w=function(e){var t=e.signOut,n=e.activeMenu;return Object(E.jsxs)("div",{className:n?"menu-mobile menu-mobile_active":"menu-mobile",children:[Object(E.jsx)("p",{className:"menu-mobile__email header__email",style:{display:n?"block":"none"},children:localStorage.getItem("email")}),Object(E.jsx)(i.b,{to:"".concat(h,"/signin"),className:"menu-mobile__auth header__link-auth",style:{color:"#A9A9A9"},onClick:t,children:"\u0412\u044b\u0439\u0442\u0438"})]})};var I=function(e){var t=e.loggedIn,n=e.signOut,c=Object(a.useState)(null),o=Object(r.a)(c,2),s=o[0],u=o[1],p=Object(a.useState)(!1),d=Object(r.a)(p,2),j=d[0],b=d[1],m=Object(l.h)().url;Object(a.useEffect)((function(){var e=function(){u(window.screen.width)};if(t)return e(),void window.addEventListener("resize",e);window.removeEventListener("resize",e)}),[t]);var O=function(){b(!j)};return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(w,{signOut:n,activeMenu:j}),Object(E.jsxs)("header",{className:"header page__position-center page__header",children:[Object(E.jsx)(i.b,{to:"".concat(h,"/mesto"),target:"_self",className:"header__link",children:Object(E.jsx)("img",{src:A,alt:"\u041c\u0435\u0441\u0442\u043e \u0420\u043e\u0441\u0441\u0438\u044f",className:"header__logo"})}),m==="".concat(h,"/signup")?Object(E.jsx)(i.b,{to:"".concat(h,"/signin"),className:"header__link-auth",children:"\u0412\u043e\u0439\u0442\u0438"}):m==="".concat(h,"/signin")?Object(E.jsx)(i.b,{to:"".concat(h,"/signup"),className:"header__link-auth",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}):void 0,t&&s<"505"?Object(E.jsx)("button",{type:"button",className:j?"header__toggle-menu header__toggle-menu_active":"header__toggle-menu",onClick:O}):t?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("p",{className:"header__email",children:localStorage.getItem("email")}),Object(E.jsx)(i.b,{to:"".concat(h,"/signin"),className:"header__link-auth",style:{color:"#A9A9A9"},onClick:n,children:"\u0412\u044b\u0439\u0442\u0438"})]}):void 0]})]})},L=c.a.createContext();var T=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,o=e.onCardDelete,s=t.owner,i=t.link,r=t.name,l=t.likes,u=Object(a.useContext)(L)._id;return Object(E.jsxs)("div",{className:"card-place",children:[Object(E.jsx)("button",{className:s._id===u?"card-place__delete-btn":"card-place__delete-btn card-place__delete-btn_display_none",onClick:function(){return o(t)}}),Object(E.jsx)("img",{src:i,alt:r,className:"card-place__img",onClick:function(){n(r,i)}}),Object(E.jsx)("h2",{className:"card-place__title",children:r}),Object(E.jsxs)("div",{className:"card-place__likes",children:[Object(E.jsx)("button",{className:l.length>0&&l.some((function(e){return e._id===u}))?"card-place__like-btn card-place__like-btn_active":"card-place__like-btn",type:"button",onClick:function(){c(t)}}),Object(E.jsx)("span",{className:"card-place__counter",children:l.length})]})]})},U=n.p+"static/media/profile-btn-edit.1e29eae2.svg",D=c.a.createContext(),F=c.a.createContext();var R=function(e){var t=e.onCardLike,n=Object(a.useContext)(L),c=n.avatar,o=n.about,s=n.name,i=Object(a.useContext)(D),r=Object(a.useContext)(F),l=r.handleEditAvatarClick,u=r.handleEditProfileClick,p=r.handleAddPlaceClick,d=r.handleCardClick,j=r.handleDeleteCardClick;return Object(E.jsxs)("main",{className:"content",children:[Object(E.jsxs)("section",{className:"profile content__position-center content__profile",children:[Object(E.jsxs)("div",{className:"profile__img-container",children:[Object(E.jsx)("img",{src:c,alt:"\u041f\u043e\u0440\u0442\u0440\u0435\u0442",className:"profile__img",style:{backgroundImage:"url(".concat(c,")")}}),Object(E.jsx)("img",{src:U,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",className:"profile__edit-img",onClick:u})]}),Object(E.jsxs)("div",{className:"profile__about",children:[Object(E.jsxs)("div",{className:"profile__container-text",children:[Object(E.jsx)("h1",{className:"profile__title-name",children:o}),Object(E.jsx)("p",{className:"profile__subtitle-does",children:s})]}),Object(E.jsx)("button",{className:"profile__edit-btn",type:"button",onClick:l})]}),Object(E.jsx)("button",{className:"profile__add-card-place",type:"button",onClick:p})]}),Object(E.jsx)("section",{className:"place content__position-center content__place",children:Object(E.jsx)("ul",{className:"place__list",children:i.length>0?i.map((function(e){return Object(E.jsx)("li",{className:"place__item",children:Object(E.jsx)(T,{card:e,onCardClick:d,onCardLike:t,onCardDelete:j})},e._id)})):Object(E.jsx)("div",{className:"place__result"})})})]})};var q=function(){return Object(E.jsx)("footer",{className:"footer page__position-center page__footer",children:Object(E.jsx)("p",{className:"footer__text-copyright",children:"\xa9 2020 Mesto Russia"})})};var B=function(e){var t=e.nameSelector,n=Object(a.useContext)(F),c=n.isShowPopupImg,o=n.closeAllPopups,s=n.selectedCard,i=s.name,r=s.link;return Object(E.jsx)("div",{className:c?"popup ".concat(t," popup_opened"):"popup ".concat(t),onClick:function(e){e.target.className==="popup ".concat(t," popup_opened")&&o()},children:Object(E.jsxs)("div",{className:"popup__container popup__container_review_img",children:[Object(E.jsx)("button",{className:"popup__btn",type:"button",onClick:o}),Object(E.jsxs)("figure",{className:"popup__img-container",children:[Object(E.jsx)("img",{src:r,className:"popup__img",alt:i}),Object(E.jsx)("figcaption",{className:"popup__img-text",children:i})]})]})})};var M=function(e){var t=e.title,n=e.name,a=e.isOpen,c=e.onClose,o=e.children,s=e.onSubmit;return Object(E.jsx)(E.Fragment,{children:Object(E.jsx)("div",{className:a?"popup ".concat(n," popup_opened"):"popup ".concat(n),onClick:function(e){e.target.className==="popup ".concat(n," popup_opened")&&c()},children:Object(E.jsxs)("div",{className:"popup__container",children:[Object(E.jsx)("button",{className:"popup__btn",type:"button",onClick:c}),Object(E.jsxs)("form",{className:"popup__form",name:n,onSubmit:s,children:[Object(E.jsx)("h2",{className:"popup__form-title",children:t}),o]})]})})})},J=Object(a.createContext)(),z={length:function(e,t,n){if(e>0)return n.length>e&&n.length<t},fieldType:function(e,t){switch(e){case"url":return function(e){return e.startsWith("https://")}(t);default:return!0}}},G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return z.lengthIsValid=z.length(t,n,e),z.fieldTypeValid=z.fieldType(a,e),!(!z.lengthIsValid||!z.fieldTypeValid)};var V=function(e){var t=e.onUpdateUser,n=e.loading,c=Object(a.useState)({profileName:"",profileDoes:""}),o=Object(r.a)(c,2),s=o[0],i=o[1],l=s.profileName,u=s.profileDoes,p=Object(a.useState)(!1),d=Object(r.a)(p,2),j=d[0],b=d[1],m=Object(a.useState)(!1),h=Object(r.a)(m,2),O=h[0],_=h[1],f=Object(a.useContext)(L),g=f.about,v=f.name,x=Object(a.useContext)(J),C=Object(a.useContext)(F),N=C.isEditAvatarPopupOpen,k=C.closeAllPopups;Object(a.useEffect)((function(){i({profileName:g,profileDoes:v})}),[g,v]),Object(a.useEffect)((function(){var e=x(s.profileName,2,40),t=x(s.profileDoes,2,200);b(e),_(t)}),[s,x]);var y=function(e){i((function(t){var n=Object.assign({},t);return n[e.target.name]=e.target.value,n}))};return Object(E.jsx)(M,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"popup_edit_profile",isOpen:N,onClose:k,onSubmit:function(e){e.preventDefault(),t(s)},children:Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("label",{className:"popup__form-label",children:[Object(E.jsx)("input",{type:"text",className:"popup__form-input popup__form-input_value_name",id:"profile-name-input",placeholder:"\u0418\u043c\u044f",name:"profileName",minLength:"2",maxLength:"40",required:!0,value:l,onChange:y,style:{borderBottom:j?"":"1px solid red"}}),Object(E.jsx)("span",{className:j?"popup__error-message profile-name-input-error":"popup__error-message profile-name-input-error popup__error-message_active",children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438"})]}),Object(E.jsxs)("label",{className:"popup__form-label",children:[Object(E.jsx)("input",{type:"text",className:"popup__form-input popup__form-input_value_does",id:"profile-does-input",placeholder:"\u0414\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c",name:"profileDoes",minLength:"2",maxLength:"200",required:!0,value:u,onChange:y,style:{borderBottom:O?"":"1px solid red"}}),Object(E.jsx)("span",{className:O?"popup__error-message profile-does-input-error":"popup__error-message profile-does-input-error popup__error-message_active",children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438"})]}),Object(E.jsx)("button",{className:"button-popup button-popup_edit_profile",type:"submit",disabled:!j||!O,style:{opacity:j&&O?"":".2"},children:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})})};var H=function(e){var t=e.onUpdateAvatar,n=e.loading,c=Object(a.useRef)(),o=Object(a.useContext)(F),s=o.isEditProfilePopupOpen,i=o.closeAllPopups;return Object(E.jsx)(M,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"popup_edit_img",isOpen:s,onClose:function(){i(),c.current.value=""},onSubmit:function(e){e.preventDefault(),t({avatar:c.current.value}),c.current.value=""},children:Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("label",{className:"popup__form-label",children:[Object(E.jsx)("input",{type:"url",className:"popup__form-input",id:"url-img-edit",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"imgEdit",required:!0,ref:c}),Object(E.jsx)("span",{className:"popup__error-message url-img-edit-error"})]}),Object(E.jsx)("button",{className:"button-popup button-popup_edit_img",type:"submit",children:n?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})})};var W=function(e){var t=e.onAddPlace,n=e.loading,c=Object(a.useState)(""),o=Object(r.a)(c,2),s=o[0],i=o[1],l=Object(a.useState)(""),u=Object(r.a)(l,2),p=u[0],d=u[1],j=Object(a.useState)("false"),b=Object(r.a)(j,2),m=b[0],h=b[1],O=Object(a.useState)("false"),_=Object(r.a)(O,2),f=_[0],g=_[1],v=Object(a.useContext)(J),x=Object(a.useContext)(F),C=x.isAddPlacePopupOpen,N=x.closeAllPopups;return Object(a.useEffect)((function(){var e=v(s,2,30),t=v(p,1,1e4,"url");h(e),g(t)}),[s,p,v]),Object(E.jsx)(M,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"popup_add_card",isOpen:C,onClose:function(){N(),i(""),d("")},onSubmit:function(e){e.preventDefault(),t({name:s,link:p}),i(""),d("")},children:Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)("label",{className:"popup__form-label",children:[Object(E.jsx)("input",{type:"text",className:"popup__form-input popup__form-input_value_place",id:"place-name-input",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"placeName",minLength:"2",maxLength:"30",required:!0,value:s,onChange:function(e){return i(e.target.value)},style:{borderBottom:m?"":"1px solid red"}}),Object(E.jsx)("span",{className:m?"popup__error-message place-name-input-error":"popup__error-message place-name-input-error popup__error-message_active",children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438"})]}),Object(E.jsxs)("label",{className:"popup__form-label",children:[Object(E.jsx)("input",{type:"url",className:"popup__form-input popup__form-input_value_img",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",id:"place-img-input",name:"placeImg",required:!0,value:p,onChange:function(e){return d(e.target.value)},style:{borderBottom:f?"":"1px solid red"}}),Object(E.jsx)("span",{className:f?"popup__error-message place-img-input-error":"popup__error-message place-img-input-error popup__error-message_active",children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438"})]}),Object(E.jsx)("button",{className:"button-popup button-popup_add_card",type:"submit",disabled:!m||!f,style:{opacity:m&&f?"":".2"},children:n?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})]})})};var K=function(e){var t=e.onRemoveCard,n=e.loading,c=Object(a.useContext)(F),o=c.isConfirmPoppup,s=c.closeAllPopups;return Object(E.jsx)(M,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"popup_remove_card",isOpen:o,onClose:s,onSubmit:function(e){e.preventDefault(),t()},children:Object(E.jsx)(E.Fragment,{children:Object(E.jsx)("button",{className:"button-popup button-popup_delete_card",type:"submit",children:n?"\u0414\u0430...":"\u0414\u0430"})})})};var Q=function(e){var t=e.setStateUser,n=e.setStateCards,c=e.loggedIn,o=e.signOut,s=Object(a.useState)(!1),i=Object(r.a)(s,2),l=i[0],u=i[1],p=Object(a.useContext)(L),d=Object(a.useContext)(D),j=Object(a.useContext)(F),b=j.closeAllPopups,m=j.cardRemove;return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(I,{loggedIn:c,signOut:o}),Object(E.jsx)(R,{onCardLike:function(e){var t;e.likes.some((function(e){return e._id===p._id}))?(t=e._id,y.deleteLike(t).then((function(e){n((function(n){return n.map((function(n){return n._id===t?e:n}))}))}))):function(e){y.putAppendLike(e).then((function(t){n((function(n){return n.map((function(n){return n._id===e?t:n}))}))}))}(e._id)}}),Object(E.jsx)(q,{}),Object(E.jsx)(V,{onUpdateUser:function(e){var n=e.profileDoes,a=e.profileName;u(!0),y.patchUpdateProfile(n,a).then((function(e){t(e),b()})).finally((function(){u(!1)}))},loading:l}),Object(E.jsx)(H,{onUpdateAvatar:function(e){var n=e.avatar;u(!0),y.patchUpdateUserAvatar(n).then((function(e){t(e),b()})).finally((function(){u(!1)}))},loading:l}),Object(E.jsx)(W,{onAddPlace:function(e){var t=e.name,a=e.link;y.postAddCard(t,a).then((function(e){n([e].concat(Object(S.a)(d))),b()}))},loading:l}),Object(E.jsx)(K,{onRemoveCard:function(){u(!0),y.deleteCard(m._id).then((function(e){n((function(e){return e.filter((function(e){return e._id!==m._id}))})),b()})).finally((function(){u(!1)}))},loading:l}),Object(E.jsx)(B,{name:"popup_edit_img"})]})},X=n(12),Y=n(10),Z=n.p+"static/media/auth-success-popup.e004e6e7.svg",$=n.p+"static/media/auth-error-popup.471086c8.svg";var ee=function(e){var t=e.name,n=e.authIn,c=e.messagePopup,o=Object(a.useContext)(F),s=o.isConfirmAuthPoppup,i=o.closeAllPopups;return Object(E.jsx)("div",{className:s?"popup ".concat(t," popup_opened"):"popup ".concat(t),onClick:function(e){e.target.className==="popup ".concat(t," popup_opened")&&i()},children:Object(E.jsxs)("div",{className:"popup__container",children:[Object(E.jsx)("button",{className:"popup__btn",type:"button",onClick:i}),Object(E.jsx)("span",{className:"popup__icon-status",style:{backgroundImage:"url(".concat(n?Z:$,")")}}),Object(E.jsx)("p",{className:"popup__auth-desc",children:n?c:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]})})};var te=function(e){var t=e.titleAuth,n=e.authIn,a=e.children,c=e.messagePopup;return Object(E.jsxs)("div",{className:"auth auth_center",children:[Object(E.jsx)("h2",{className:"auth__title",children:t}),a,Object(E.jsx)(ee,{authIn:n,name:"popup_auth_message",messagePopup:c})]})},ne=b,ae=m,ce=ae.reg,oe=ae.login,se=ae.checkToken,ie=function(e){return e.ok?e.json():Promise.reject(e.json())};var re=function(){var e=Object(a.useState)({authEmail:"",authPassword:""}),t=Object(r.a)(e,2),n=t[0],c=t[1],o=n.authEmail,s=n.authPassword,u=Object(a.useState)(!1),p=Object(r.a)(u,2),d=p[0],j=p[1],b=Object(a.useContext)(F),m=b.handAuthClick,O=b.closeAllPopups,_=Object(l.g)(),f=function(e){var t=e.target,n=t.name,a=t.value;c((function(e){return Object(Y.a)(Object(Y.a)({},e),{},Object(X.a)({},n,a))}))};return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(I,{}),Object(E.jsx)(te,{titleAuth:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",authIn:d,messagePopup:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",children:Object(E.jsxs)("form",{className:"auth__form",name:"registrationInMesto",onSubmit:function(e){var t;e.preventDefault(),(t={password:s,email:o},fetch("".concat(ne,"/").concat(ce),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(ie)).then((function(e){e.data.email?localStorage.setItem("email",e.data.email):localStorage.setItem("email","\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0412\u0430\u0448 email"),j(!0),c({authEmail:"",authPassword:""}),setTimeout((function(){_.push("".concat(h,"/signin")),O()}),2e3)})).catch((function(e){e.then((function(e){console.error(e.error),j(!1)}))})).finally((function(){m()}))},children:[Object(E.jsx)("input",{type:"email",name:"authEmail",className:"auth__field-text",placeholder:"Email",required:!0,onChange:f,value:o}),Object(E.jsx)("input",{type:"password",name:"authPassword",className:"auth__field-text",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0,onChange:f,value:s}),Object(E.jsx)("button",{className:"auth__form-button",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(E.jsxs)("p",{className:"auth__desc",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",Object(E.jsx)(i.b,{to:"".concat(h,"/signin"),className:"auth__link",children:"\xa0\u0412\u043e\u0439\u0442\u0438"})]})]})})]})};var le=function(e){var t=e.handleLogin,n=Object(a.useState)({authEmail:"",authPassword:""}),c=Object(r.a)(n,2),o=c[0],s=c[1],i=o.authEmail,u=o.authPassword,p=Object(a.useState)(!1),d=Object(r.a)(p,2),j=d[0],b=d[1],m=Object(a.useContext)(F),O=m.handAuthClick,_=m.closeAllPopups,f=Object(l.g)(),g=function(e){var t=e.target,n=t.name,a=t.value;s((function(e){return Object(Y.a)(Object(Y.a)({},e),{},Object(X.a)({},n,a))}))};return Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)(I,{}),Object(E.jsx)(te,{titleAuth:"\u0412\u0445\u043e\u0434",authIn:j,messagePopup:"\u0423\u0441\u043f\u0435\u0445. \u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435...",children:Object(E.jsxs)("form",{className:"auth__form",name:"loginInMesto",onSubmit:function(e){var n;e.preventDefault(),(n={password:u,email:i},fetch("".concat(ne,"/").concat(oe),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(ie)).then((function(e){e.token&&(localStorage.setItem("jwt",e.token),s({authEmail:"",authPassword:""}),t(),b(!0),setTimeout((function(){f.push("".concat(h,"/mesto")),_()}),2e3))})).catch((function(e){e.then((function(e){console.error(e.message),b(!1)}))})).finally((function(){O()}))},children:[Object(E.jsx)("input",{type:"email",name:"authEmail",className:"auth__field-text",placeholder:"Email",required:!0,onChange:g,value:i}),Object(E.jsx)("input",{type:"password",name:"authPassword",className:"auth__field-text",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0,onChange:g,value:u}),Object(E.jsx)("button",{className:"auth__form-button",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})},ue=n(26),pe=["component","path"],de=function(e){var t=e.component,n=e.path,a=Object(ue.a)(e,pe);return Object(E.jsx)(l.b,{path:n,children:a.loggedIn?Object(E.jsx)(t,Object(Y.a)({},a)):Object(E.jsx)(l.a,{to:"".concat(h,"/signin")})})};var je=function(){var e=Object(a.useState)({about:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",name:"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u043f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435",avatar:P}),t=Object(r.a)(e,2),n=t[0],o=t[1],s=c.a.useState([]),i=Object(r.a)(s,2),u=i[0],p=i[1];Object(a.useEffect)((function(){Promise.all([y.getInitialUser(),y.getInitialCards()]).then((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];o(n),p(a)}))}),[]);var d=Object(a.useState)({}),j=Object(r.a)(d,2),b=j[0],m=j[1],O=Object(a.useState)(!1),_=Object(r.a)(O,2),f=_[0],g=_[1],v=Object(a.useState)(!1),x=Object(r.a)(v,2),C=x[0],N=x[1],k=Object(a.useState)(!1),S=Object(r.a)(k,2),A=S[0],w=S[1],I=Object(a.useState)(!1),T=Object(r.a)(I,2),U=T[0],R=T[1],q=Object(a.useState)(!1),B=Object(r.a)(q,2),M=B[0],z=B[1],V=Object(a.useState)(!1),H=Object(r.a)(V,2),W=H[0],K=H[1],X=c.a.useState({}),Y=Object(r.a)(X,2),Z=Y[0],$=Y[1],ee=c.a.useState(!1),te=Object(r.a)(ee,2),ae=te[0],ce=te[1];function oe(){g(!1),N(!1),w(!1),R(!1),z(!1),K(!1)}var ue=Object(l.g)();Object(a.useEffect)((function(){localStorage.getItem("jwt")&&function(e){return fetch("".concat(ne,"/").concat(se),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(ie)}(localStorage.getItem("jwt")).then((function(e){e.data.email?localStorage.setItem("email",e.data.email):localStorage.setItem("email","\u0417\u0434\u0435\u0441\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0412\u0430\u0448 email"),ce(!0),ue.push("".concat(h,"/mesto"))}))})),Object(a.useEffect)((function(){var e=function(e){"Escape"===e.key&&oe()};return(C||A||f||U||M||W)&&document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[C,A,f,U,M,W]);var pe={closeAllPopups:oe,handleEditAvatarClick:function(){g(!0)},handleEditProfileClick:function(){N(!0)},handleAddPlaceClick:function(){w(!0)},handleCardClick:function(e,t){m({name:e,link:t}),R(!0)},handleDeleteCardClick:function(e){z(!0),$(e)},handAuthClick:function(){K(!0)},isEditProfilePopupOpen:C,isEditAvatarPopupOpen:f,isAddPlacePopupOpen:A,isConfirmPoppup:M,isShowPopupImg:U,selectedCard:b,cardRemove:Z,isConfirmAuthPoppup:W};return Object(E.jsx)(J.Provider,{value:G,children:Object(E.jsx)(L.Provider,{value:n,children:Object(E.jsx)(D.Provider,{value:u,children:Object(E.jsx)(F.Provider,{value:pe,children:Object(E.jsxs)(l.d,{children:[Object(E.jsx)(de,{path:"".concat(h,"/mesto"),loggedIn:ae,signOut:function(){localStorage.removeItem("jwt"),ue.push("".concat(h,"/signin")),ce(!1)},setStateUser:o,setStateCards:p,component:Q}),Object(E.jsx)(l.b,{path:"".concat(h,"/signup"),children:Object(E.jsx)(re,{})}),Object(E.jsx)(l.b,{path:"".concat(h,"/signin"),children:Object(E.jsx)(le,{handleLogin:function(){ce(!0)}})}),Object(E.jsx)(l.b,{path:"*",children:ae?Object(E.jsx)(l.a,{to:"".concat(h,"/mesto")}):Object(E.jsx)(l.a,{to:"".concat(h,"/signin")})})]})})})})})},be=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,42)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(E.jsx)(c.a.StrictMode,{children:Object(E.jsx)(i.a,{children:Object(E.jsx)(je,{})})}),document.getElementById("root")),be()}},[[41,1,2]]]);
//# sourceMappingURL=main.f950afcb.chunk.js.map